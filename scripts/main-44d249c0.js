"use strict";angular.module("workspace",["ngAnimate","ngTouch","ngSanitize","firebase","ngRoute"]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"partials/main.html",controller:"MainCtrl"}).when("/details",{templateUrl:"partials/details.html",controller:"DetailsCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("workspace").factory("RestFct",["$http",function(e){var t="http://pokeapi.co/api/v1/",o=function(){return{get:function(o,n,i){e({method:"GET",url:t+o}).success(n).error(i)}}}(),n={description:{find:function(e,t,n){o.get("description/"+e+"/",t,n)}},pokemon:{listAll:function(e,t){o.get("pokedex/1/",e,t)},find:function(e,t,n){o.get("pokemon/"+e+"/",t,n)}},sprite:{find:function(e,t,n){o.get("sprite/"+e+"/",t,n)}}};return n}]),angular.module("workspace").factory("PokeListFct",["RestFct","$location",function(e,t){var o={selected:null,select:function(n){e.pokemon.find(n.api,function(e){o.preparePokemon(e),t.url("details")},function(e){console.log(e)})},list:[],start:function(){e.pokemon.listAll(function(e){o.prepareList(e.pokemon)},function(e){console.log(e)})},preparePokemon:function(e){o.setProperties(e),e.sprite=o.getNumber(e.sprites[0].resource_uri),e.description=o.getNumber(e.descriptions[0].resource_uri),o.selected=e,o.getPokemonSprite(e.sprite),o.getPokemonDescription(e.description)},prepareList:function(e){o.list=e,o.list.map(o.setProperties),o.list=o.list.filter(o.removeSpecialForms),o.list=o.list.sort(o.sort)},setProperties:function(e){e.api=o.getNumber(e.resource_uri),e.number=o.getPokemonNumber(e.api),e.api=parseInt(e.api),e.name=o.getName(e.name)},getNumber:function(e){return e.replace(/([a-z][0-9])|\D/gi,"")},getName:function(e){return e.replace(/-[a-z]{3,}/gi,"")},getPokemonNumber:function(e){return e.length<=3?("000"+e).slice(-3):null},getPokemonSprite:function(t){e.sprite.find(t,function(e){o.selected.sprite="http://pokeapi.co"+e.image},function(e){console.log(e)})},getPokemonDescription:function(t){e.description.find(t,function(e){o.selected.description=e.description},function(e){console.log(e)})},removeSpecialForms:function(e){return e.number?!0:!1},sort:function(e,t){return e.api>t.api?1:e.api<t.api?-1:0}};return o.start(),o}]),angular.module("workspace").controller("MainCtrl",["$scope","PokeListFct",function(e,t){e.Pokemon=t,e.View={filter:""},$(document).on("scroll",function(){var e=$(this).scrollTop();$(".pokeball-back").css({transform:"translateY(-50%) rotateZ("+e/15+"deg)"})})}]),angular.module("workspace").controller("DetailsCtrl",["$scope","$firebaseArray","PokeListFct","$location",function(e,t,o,n){e.Pokemon=o.selected,e.Pokemon||n.url("/"),e.View={back:function(){n.url("/")}},e.Comments={list:[],newComment:{name:"",email:"",text:"",pokemon:e.Pokemon?e.Pokemon.name:""},add:function(){if(this.validateBeforeSend()){var t=angular.copy(this.newComment);this.list.$add(t),this.newComment={pokemon:e.Pokemon?e.Pokemon.name:""}}},start:function(){var o=new Firebase("http://webpokedex.firebaseio.com/comments/"+(e.Pokemon?e.Pokemon.name:""));this.list=t(o)},validateBeforeSend:function(){return this.newComment.name?this.validateEmail(this.newComment.email)?this.newComment.text?!0:(alert("Write something to comment"),!1):(alert("Insert a valid email to comment"),!1):(alert("Insert your name to comment"),!1)},validateEmail:function(e){var t=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return t.test(e)}},e.Comments.start()}]),function(e){try{e=angular.module("workspace")}catch(t){e=angular.module("workspace",[])}e.run(["$templateCache",function(e){e.put("partials/details.html",'<header id="poke-top"><button class="btn-back" ng-click="View.back()">back</button><div id="pokemon-id">{{Pokemon.number}} - {{Pokemon.name}}</div><div id="pokemon-types"><img class="pokemon-type" src="" ng-repeat="type in Pokemon.types" ng-src="http://serebii.net/pokedex-bw/type/{{type.name}}.gif"></div></header><section id="poke-description"><div id="pokemon-hw"><b>Height:</b> {{Pokemon.height}}<br><b>Weight:</b> {{Pokemon.weight}}<br></div><img id="pokemon-sprite" src="" ng-src="{{Pokemon.sprite}}"><div id="poke-info"><div id="pokemon-description">{{Pokemon.description}}</div><div id="pokemon-stats"><b>HP:</b> {{Pokemon.hp}}<br><b>Attack:</b> {{Pokemon.attack}}<br><b>SP Attack:</b> {{Pokemon.sp_atk}}<br><b>Defense:</b> {{Pokemon.defense}}<br><b>SP Defense:</b> {{Pokemon.sp_def}}<br><b>Speed:</b> {{Pokemon.speed}}<br></div></div></section><section class="poke-comments-section"><ul class="poke-comments"><li class="poke-comments-list-item new-comment"><div class="comments-user"><img src="images/user.png"></div><div class="comments-body"><input type="text" placeholder="Your Name" ng-model="Comments.newComment.name"> <input type="email" placeholder="Your Email" ng-model="Comments.newComment.email"> <textarea placeholder="New Comment" ng-model="Comments.newComment.text"></textarea> <button ng-click="Comments.add()">Send</button></div></li><li class="poke-comments-list-item" ng-repeat="comment in Comments.list"><div class="comments-user"><img src="images/user.png"></div><div class="comments-body"><span>{{comment.name}}</span><p>{{comment.text}}</p></div></li></ul></section>')}])}(),function(e){try{e=angular.module("workspace")}catch(t){e=angular.module("workspace",[])}e.run(["$templateCache",function(e){e.put("partials/main.html",'<div><img class="pokeball-back" src="images/pokeball.svg"> <input type="text" id="poke-filter" placeholder="Search" maxlength="20" ng-model="View.filter"><ul class="poke-list"><li class="poke-list-item poke-captured" ng-repeat="pokemon in Pokemon.list | filter: View.filter" ng-click="Pokemon.select(pokemon)">{{pokemon.number}} - {{pokemon.name}}</li></ul></div>')}])}();